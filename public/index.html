<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3D Geometric Search Engine</title>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ”</text></svg>"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <h1>ğŸ” 3D Geometric Search Engine</h1>
        <p>Find similar 3D models based on geometric similarity</p>
      </header>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Left Panel: Upload & Controls -->
        <aside class="sidebar">
          <div class="panel">
            <h2>Upload Model</h2>
            <div class="upload-area" id="uploadArea">
              <div class="upload-icon">ğŸ“</div>
              <p>Drag & drop 3D files here</p>
              <p class="upload-hint">or click to browse</p>
              <input
                type="file"
                id="fileInput"
                accept=".gltf,.glb,.step,.stp,.obj,.stl"
                style="display: none"
              />
            </div>
            <div class="supported-formats">
              <strong>Supported formats:</strong>
              <ul>
                <li>glTF / GLB</li>
                <li>STEP (.stp, .step)</li>
                <li>OBJ</li>
                <li>STL</li>
              </ul>
            </div>
          </div>

          <div class="panel">
            <h2>Template Shapes</h2>
            <div class="template-grid">
              <button class="template-btn" data-shape="cube">ğŸ”² Cube</button>
              <button class="template-btn" data-shape="sphere">
                âšª Sphere
              </button>
              <button class="template-btn" data-shape="cylinder">
                ğŸ¥« Cylinder
              </button>
              <button class="template-btn" data-shape="cone">ğŸ”º Cone</button>
              <button class="template-btn" data-shape="torus">ğŸ© Torus</button>
              <button class="template-btn" data-shape="tetrahedron">
                â—† Tetrahedron
              </button>
            </div>
          </div>

          <div class="panel" id="searchControls" style="display: none">
            <h2>Search Settings</h2>
            <div class="control-group">
              <label for="thresholdSlider"
                >Similarity Threshold:
                <span id="thresholdValue">0.70</span></label
              >
              <input
                type="range"
                id="thresholdSlider"
                min="0.1"
                max="1.0"
                step="0.05"
                value="0.70"
              />
            </div>
            <div class="control-group">
              <label for="limitSlider"
                >Max Results: <span id="limitValue">10</span></label
              >
              <input
                type="range"
                id="limitSlider"
                min="1"
                max="50"
                step="1"
                value="10"
              />
            </div>
            <button class="btn btn-primary" id="searchBtn">
              ğŸ” Find Similar Models
            </button>
          </div>

          <div class="panel" id="modelInfo" style="display: none">
            <h2>Model Information</h2>
            <div id="modelDetails"></div>
          </div>
        </aside>

        <!-- Center: 3D Viewer -->
        <main class="viewer-section">
          <div class="viewer-header">
            <h2 id="viewerTitle">3D Viewer</h2>

            <!-- Camera Controls -->
            <div class="control-section">
              <label class="control-label">Camera</label>
              <div class="viewer-controls">
                <button
                  class="icon-btn"
                  id="zoomInBtn"
                  title="Zoom In (Camera closer)"
                >
                  ğŸ”+
                </button>
                <button
                  class="icon-btn"
                  id="zoomOutBtn"
                  title="Zoom Out (Camera farther)"
                >
                  ğŸ”âˆ’
                </button>
                <button
                  class="icon-btn"
                  id="resetViewBtn"
                  title="Reset Camera Position"
                >
                  ğŸ”„
                </button>
                <button class="icon-btn" id="topViewBtn" title="Top View">
                  â¬‡ï¸
                </button>
                <button class="icon-btn" id="frontViewBtn" title="Front View">
                  â¡ï¸
                </button>
                <button class="icon-btn" id="sideViewBtn" title="Side View">
                  â†—ï¸
                </button>
              </div>
            </div>

            <!-- Model Controls -->
            <div class="control-section">
              <label class="control-label">Model Scale</label>
              <div class="viewer-controls">
                <button
                  class="icon-btn"
                  id="scaleDownBtn"
                  title="Decrease Model Size"
                >
                  ğŸ”½
                </button>
                <button
                  class="icon-btn"
                  id="scaleUpBtn"
                  title="Increase Model Size"
                >
                  ğŸ”¼
                </button>
                <button
                  class="icon-btn"
                  id="scaleResetBtn"
                  title="Reset Scale to 0.1x"
                >
                  â†©ï¸
                </button>
                <span class="scale-display"
                  >Scale: <span id="scaleValue">0.10</span>x</span
                >
              </div>
            </div>

            <!-- Display Controls -->
            <div class="control-section">
              <label class="control-label">Display</label>
              <div class="viewer-controls">
                <button
                  class="icon-btn"
                  id="wireframeBtn"
                  title="Toggle Wireframe Mode"
                >
                  ğŸ•¸ï¸
                </button>
                <button class="icon-btn" id="gridToggleBtn" title="Toggle Grid">
                  #ï¸âƒ£
                </button>
                <button class="icon-btn" id="axesToggleBtn" title="Toggle Axes">
                  ğŸ“
                </button>
                <button
                  class="icon-btn"
                  id="backgroundBtn"
                  title="Change Background"
                >
                  ğŸ¨
                </button>
                <button
                  class="icon-btn"
                  id="fullscreenBtn"
                  title="Fullscreen Mode"
                >
                  â›¶
                </button>
              </div>
            </div>
          </div>
          <div id="viewer3D" class="viewer-3d"></div>
          <div class="viewer-footer">
            <span class="hint"
              >ğŸ–±ï¸ Left-click: Rotate | Right-click: Pan | Scroll: Zoom</span
            >
          </div>
        </main>

        <!-- Right Panel: Search Results -->
        <aside class="results-panel">
          <div class="panel">
            <h2>My Models (<span id="modelCount">0</span>)</h2>
            <div id="modelList" class="model-list"></div>
          </div>

          <div class="panel" id="searchResultsPanel" style="display: none">
            <h2>Search Results</h2>
            <div id="searchResults" class="search-results"></div>
          </div>
        </aside>
      </div>

      <!-- Status Bar -->
      <div class="status-bar">
        <span id="statusMessage">Ready</span>
        <div id="progressBar" class="progress-bar" style="display: none">
          <div class="progress-fill" id="progressFill"></div>
        </div>
      </div>
    </div>

    <!-- Modal for detailed comparison -->
    <div id="comparisonModal" class="modal" style="display: none">
      <div class="modal-content">
        <span class="modal-close">&times;</span>
        <h2>Feature Comparison</h2>
        <div id="comparisonDetails"></div>
      </div>
    </div>

    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
      }
    </script>
    <script type="module" src="viewer.js"></script>
    <script type="module" src="app.js"></script>
  </body>
</html>
